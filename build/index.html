<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset='utf-8'>
	<meta name='viewport' content='width=device-width,initial-scale=1'>
	<title>PIXXIO LIB</title>
	<link rel='icon' type='image/png' href='/favicon.png'>
	<link rel="stylesheet" href="pixxio.jsdk.css">
</head>

<body>
	<!-- EMBEED SCRIPT -->
	<button id="btn">select file over pixxio</button>
	<button id="btn2">select file over pixxio</button>
	<button id="btn3">upload file to pixxio</button>
	<input type="file">
	<p>
		Set your appKey and appUrl first to test this integration library.
	</p>
	<div id="test" style="padding: 10px; border: 3px solid grey"></div>
	<script src='pixxio.jsdk.min.js'></script>
	<script type="application/javascript">
		var p = new PIXXIO({
			element: document.querySelector('#test'),
			modal: true,
			appKey: 'd75pK5J2an9U4a2HjsMc7EL0V',
      // appUrl: 'https://steylish.px.media'
			language: 'de'
		});

		function setImage(file) {
			var image = new Image();
			image.src = file.url;
			document.body.appendChild(image);
		}
		
		document.querySelector('#btn').addEventListener('click', (e) => {
			e.preventDefault();
			p.getMedia({ 
				max: -1, 
				allowTypes: ['jpg', 'png'],
				showSelection: false
				// allowedFormats: ['preview']
			 }).then((selectedFiles) => {
				selectedFiles.forEach(f => setImage(f));
			}).catch(() => {
				console.log('closed')
			});
		})


		document.querySelector('#btn2').addEventListener('click', (e) => {
			e.preventDefault();
			p.getMedia({ 
				max: 1, 
				allowTypes: ['psd'],
			  allowFormats: ['preview']
			 }).then((selectedFiles) => {
				selectedFiles.forEach(f => setImage(f));
			}).catch(() => {
				console.log('closed');
			});
		});

		document.querySelector('#btn3').addEventListener('click', (e) => {
			var file = document.querySelector('input[type=file]').files[0];
			e.preventDefault();
			p.pushMedia({ 
				file: file,
				metadataToCopy: ['all']
			}).then((response) => {
				console.log(response)
			}).catch(() => {
		
			});
		})

		p.on('authState', function (value) {
			console.log('LOGIN ', value);
			if (value.login) {
				p.getFileById(5185).then((data) => console.log(data));
				p.checkVersionChanged([5530,5520,5498,5496,5515,5524,5525,5514,5517,5521,5516]).then(response => {
					console.log(response);
				})
			}

		})

	</script>
</body>
</html>
